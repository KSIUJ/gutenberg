{% extends 'common/bootstrap.html' %}

{% load bootstrap4 %}
{% load static %}

{% block bootstrap4_content %}
    <nav class="navbar navbar-expand navbar-dark bg-dark fixed-top">
        <a class="navbar-brand" href="{% url 'print' %}">
            <img srcset="{% static 'img/logo-30.png' %},
                         {% static 'img/logo-60.png' %} 2x,
                         {% static 'img/logo-90.png' %} 3x,
                         {% static 'img/logo-120.png' %} 4x"
                 src="{% static 'img/logo-30.png' %}" alt="">
            Gutenberg
        </a>

        <ul class="navbar-nav ml-auto">
            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" id="nav_dropdown"
                   role="button" data-toggle="dropdown" aria-haspopup="true"
                   aria-expanded="false">
                    {% if request.user.last_name %}
                        {{ request.user.first_name }}
                        {{ request.user.last_name }}
                    {% else %}
                        {{ request.user }}
                    {% endif %}
                </a>
                <div class="dropdown-menu dropdown-menu-right"
                     aria-labelledby="nav_dropdown">
                    <form action="{% url 'oidc_logout' %}" method="post" id="logout-form">
                        {% csrf_token %}
                    </form>
                    <a class="dropdown-item" href="#" onclick="document.getElementById('logout-form').submit();">
                        Sign out
                    </a>
                </div>
            </li>
        </ul>
    </nav>

    <main class="container">
        <h1 class="display-4 mt-3">{% block title %}{% endblock %}</h1>

        {% autoescape off %}{% bootstrap_messages %}{% endautoescape %}

        {% block content %}{% endblock %}

        <div class="alert alert-secondary mt-5" role="alert">
            <h5>You can print directly from your device using IPP</h5>
            {% url 'ipp_endpoint' request.user.api_key 'print' as ipp_url %}
            <div>Your personal IPP endpoint: <b>ipp{% if request.is_secure %}s{% endif %}://{{request.META.HTTP_HOST}}:{% if request.is_secure %}443{% else %}80{% endif %}{{ ipp_url }}</b></div>
            <div>Do not share this with others - all files printed using this address will be accounted to your quota</div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
        <span class="text-muted">
            &copy; <a href="https://ksi.ii.uj.edu.pl">KSI UJ</a> |
            <a href="https://github.com/KSIUJ/gutenberg">Source</a>
        </span>
        </div>
    </footer>
{% endblock %}
